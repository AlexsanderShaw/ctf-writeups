## LostFlower (reverse, 250p)

[LostFlower.apk.fd2bbce976cb355919c8209b69a56a52](./LostFlower.apk.fd2bbce976cb355919c8209b69a56a52)

---------------------------------------

### 思路
这是一个apk程序，安装后发现要输入正确的数字才可以获得flag。用`jeb`查看java代码，很简单的逻辑，获取一个数字，之后通过JNI判断是否正确。  
so代码混淆了，IDA f5出来的代码不是很正确。混淆方式是采用多重循环加条件判断来混淆了程序的流程。查看了函数列表，发现 check1/check2/check3/check4 这四个函数。由于程序流程被混淆了，所以还是用动态调试来确认下运行顺序。IDA远程调试apk，借助idapython脚本下断点，慢慢调试。  
整个程序的逻辑还是很简单的：
```
1. 输入的密码 a 为10位长 （注意虽然可以输入更长，但不作用，因为int的范围为[-2147483648, 2147483647]）
2. 把a每个位上的数字查表转换, 累加求和为b
3. 如果`abs(a-b)`小于零，那么密码就是正确的，之后根据密码生成flag
```

关键就在于 `abs(a-b) < 0` 为何会成立？想了好久才知道，如果 `a-b = -2147483648`, 那么取反后由于溢出，还是负的。  
取值范围不是很大，采用爆破方式查找符合要求的数字。代码请看[LostFlower_ans.py](./LostFlower_ans.py)

